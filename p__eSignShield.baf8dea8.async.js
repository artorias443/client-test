(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[12],{Dvug:function(e,t,a){e.exports={eSignShield:"antd-pro-pages-e-sign-shield-index-eSignShield",tabs:"antd-pro-pages-e-sign-shield-index-tabs",ukeyContainer:"antd-pro-pages-e-sign-shield-index-ukeyContainer",mobileContainer:"antd-pro-pages-e-sign-shield-index-mobileContainer",certSelect:"antd-pro-pages-e-sign-shield-index-certSelect",form:"antd-pro-pages-e-sign-shield-index-form",desc:"antd-pro-pages-e-sign-shield-index-desc",refresh:"antd-pro-pages-e-sign-shield-index-refresh",refreshItem:"antd-pro-pages-e-sign-shield-index-refreshItem",footer:"antd-pro-pages-e-sign-shield-index-footer",subBtn:"antd-pro-pages-e-sign-shield-index-subBtn",qrcode:"antd-pro-pages-e-sign-shield-index-qrcode",loginHeader:"antd-pro-pages-e-sign-shield-index-loginHeader",mt20:"antd-pro-pages-e-sign-shield-index-mt20",certItem:"antd-pro-pages-e-sign-shield-index-certItem"}},JEuE:function(e,t,a){"use strict";a.r(t);a("Znn+");var n=a("ZTPi"),r=a("qLMh"),c=a("9og8"),s=a("tJVT"),l=a("q1tI"),i=a.n(l),o=a("9kvl"),u=a("Ty5D"),d=a("z0WU"),m=a("Dvug"),b=a.n(m),f=(a("+L6B"),a("2/Rp")),p=(a("y8nQ"),a("Vl3Y")),O=(a("OaEy"),a("2fM7")),j=a("Tex+"),v=a("ntyT"),E=a("JYHG"),g=a("nvA3"),y=a.n(g),h=a("3OeY"),C=a.n(h),S=a("vwhI"),k=a.n(S),N=a("xqX8"),w=function(e){var t=e.location.query,a=e.activeKey,n=e.clientCode,o=e.changeStatus,u=e.sealSource,m=O["a"].Option;t=Object(d["k"])(t);var g=p["a"].useForm(),h=Object(s["a"])(g,1),S=h[0],w=Object(l["useState"])(null),x=Object(s["a"])(w,2),K=x[0],U=x[1],I=Object(l["useState"])([]),_=Object(s["a"])(I,2),A=_[0],M=_[1],B=Object(l["useState"])(!0),L=Object(s["a"])(B,2),F=L[0],T=L[1],Y=Object(l["useState"])(!1),q=Object(s["a"])(Y,2),P=q[0],W=q[1],D=Object(l["useState"])(!1),G=Object(s["a"])(D,2),J=G[0],R=G[1];Object(l["useEffect"])((function(){"CA_UKEY"===a&&S.resetFields()}),[a]),Object(l["useEffect"])((function(){u.length>0&&V()}),[u]);var V=function(){var e=Object(c["a"])(Object(r["a"])().mark((function e(){var a,c;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return T(!0),a=u.filter((function(e){return"CA_UKEY"===e.sourceName})),e.next=4,Object(j["u"])(n,t.SignatureMode,a);case 4:c=e.sent,T(!1),c&&("string"==typeof c?U("\u672a\u68c0\u6d4b\u5230Ukey\uff0c\u8bf7\u68c0\u67e5Ukey\u662f\u5426\u63d2\u5165"===c?"\u672a\u68c0\u6d4b\u5230Ukey\uff0c\u8bf7\u68c0\u67e5Ukey\u662f\u5426\u63d2\u5165\uff0c\u5982\u5df2\u6838\u51c6\uff0c\u8bf7\u70b9\u51fb":c):Array.isArray(c)&&(c.length?c.length>1?U("\u68c0\u6d4b\u5230\u63d2\u5165\u591a\u4e2aUKey\uff0c\u8bf7\u79fb\u9664\u5176\u4ed6UKey"):(S.setFieldValue("encryptKey",c[0].encryptKeyBase64),M(c)):U("\u672a\u627e\u5230\u6307\u5b9a\u8bc1\u4e66")));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),H=function(){P||(U(null),M([]),V())},z=function(){P||S.validateFields().then(function(){var e=Object(c["a"])(Object(r["a"])().mark((function e(a){var c,s;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c={isFile:1,source:t.source,dest:t.dest,keyword:a.encryptKey,sourceName:"CA_UKEY",clientCode:n},W(!0),o(!0),eSign.UrlContainer.LockWindow(!0),e.next=6,Object(v["D"])(c);case 6:s=e.sent,eSign.UrlContainer.LockWindow(!1),W(!1),o(!1),0!==s.data.errorCode?U(s.data.errorMsg):(R(!0),U("\u6807\u4e66\u52a0\u5bc6\u6210\u529f!"),setTimeout((function(){eSign.UrlContainer.SetResult(JSON.stringify({result:"1"}))}),1e3));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){}))};return i.a.createElement("div",null,i.a.createElement("div",null,!K&&i.a.createElement(i.a.Fragment,null,F&&i.a.createElement(N["a"],null),!F&&i.a.createElement("div",{className:b.a.ukeyContainer},i.a.createElement(p["a"],{form:S,className:b.a.form,labelCol:{span:5},wrapperCol:{span:19},autoComplete:"off"},i.a.createElement(p["a"].Item,{label:"\u52a0\u5bc6\u8bc1\u4e66"},i.a.createElement(p["a"].Item,{name:"encryptKey",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u52a0\u5bc6\u8bc1\u4e66"}]},i.a.createElement(O["a"],{className:b.a.certSelect,disabled:P},A.map((function(e){return i.a.createElement(m,{key:e.encryptKeyBase64,value:e.encryptKeyBase64},e.certCN)})))),i.a.createElement(p["a"].Item,{className:b.a.refreshItem},i.a.createElement("img",{src:C.a,alt:"\u5237\u65b0",title:"\u5237\u65b0",className:b.a.refresh,onClick:H}))),i.a.createElement(p["a"].Item,{label:"\u539f\u59cb\u6587\u4ef6\u8def\u5f84"},i.a.createElement("div",{className:b.a.desc},t.source||"--")),i.a.createElement(p["a"].Item,{label:"\u52a0\u5bc6\u540e\u6587\u4ef6\u8def\u5f84"},i.a.createElement("div",{className:b.a.desc},t.dest||"--"))),i.a.createElement("div",{className:b.a.footer},i.a.createElement(f["a"],{className:b.a.subBtn,onClick:z,loading:P},P?"\u52a0\u5bc6\u4e2d":"\u52a0\u5bc6")))),K&&i.a.createElement(E["a"],{src:J?k.a:y.a,block:!0,customStyle:{width:"320px",margin:"0 auto",color:"#b3b3b3",paddingTop:"80px"}},i.a.createElement("div",{className:b.a.mt20},i.a.createElement("div",null,K),!J&&i.a.createElement("div",{className:b.a.refresh,onClick:H},"\u7acb\u5373\u5237\u65b0")))))},x=Object(o["a"])((function(e){var t=e.indexPageModel;return{state:t}}))(Object(u["n"])(w)),K=a("+n12"),U=a("D1Df"),I=a.n(U),_=function(e){var t=e.location.query,a=e.activeKey,n=e.clientCode,o=e.changeStatus;t=Object(d["k"])(t);var u=Object(l["useState"])(null),m=Object(s["a"])(u,2),O=m[0],j=m[1],g=Object(l["useState"])(!1),h=Object(s["a"])(g,2),C=h[0],S=h[1],w=Object(l["useState"])(null),x=Object(s["a"])(w,2),U=x[0],_=x[1],A=Object(l["useState"])(!1),M=Object(s["a"])(A,2),B=M[0],L=M[1],F=Object(l["useState"])(!1),T=Object(s["a"])(F,2),Y=T[0],q=T[1],P=Object(l["useState"])(null),W=Object(s["a"])(P,2),D=W[0],G=W[1],J=Object(l["useState"])(null),R=Object(s["a"])(J,2),V=R[0],H=R[1],z=Object(l["useState"])(!1),Z=Object(s["a"])(z,2),Q=Z[0],X=Z[1],$=Object(l["useState"])(!1),ee=Object(s["a"])($,2),te=ee[0],ae=ee[1],ne=Object(l["useRef"])();Object(l["useEffect"])((function(){return function(){ne.current&&clearInterval(ne.current)}}),[]),Object(l["useEffect"])((function(){j(null),_(null),ne.current&&clearInterval(ne.current),"CA_MOBILE"===a&&re()}),[a]),Object(l["useEffect"])((function(){B&&(ne.current&&clearInterval(ne.current),Object(c["a"])(Object(r["a"])().mark((function e(){var t,a;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(v["g"])({clientCode:n,sourceName:"CA_MOBILE",providerName:"e\u7b7e\u76fe"});case 2:t=e.sent,0==t.data.code&&(a=t.data.subjectLists[0].certs[0],G(a.encryptKeyBase64),H(a.certCN));case 4:case"end":return e.stop()}}),e)})))())}),[B]),Object(l["useEffect"])((function(){U?ne.current=setInterval((function(){ce()}),1e3):clearInterval(ne.current)}),[U]);var re=function(){var e={clientCode:n,sourceName:"CA_MOBILE",providerName:"e\u7b7e\u76fe"};S(!0),Y||Object(v["h"])(e).then((function(e){var t=e.data,a=t.code;t.CAProviderList;0==a&&q(!0)})),Object(v["j"])(e).then((function(t){var a="0"==t.data.isLogin;L(!a),a?Object(v["i"])(e).then((function(e){S(!1);var t=e.data,a=t.data.url,n=t.code,r=t.reMark,c=t.message;0==n?(_(a),Object(K["vb"])("scanTypeTip",r,1)):1490004==n&&j(c)})):S(!1)}))},ce=function(){var e=Object(c["a"])(Object(r["a"])().mark((function e(){var t;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(v["d"])({clientCode:n,sourceName:"CA_MOBILE"});case 2:t=e.sent,0==t.data.code?L(1==t.data.data.status):6==t.data.code&&(ne.current&&clearInterval(ne.current),j("\u7f51\u7edc\u5f02\u5e38"));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),se=function(){ne.current&&clearInterval(ne.current),j(null),L(!1),G(!1),re()},le=function(){var e=Object(c["a"])(Object(r["a"])().mark((function e(){var a,c;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return a={isFile:1,source:t.source,dest:t.dest,keyword:D,sourceName:"CA_MOBILE",clientCode:n},X(!0),o(!0),eSign.UrlContainer.LockWindow(!0),e.next=6,Object(v["D"])(a);case 6:c=e.sent,eSign.UrlContainer.LockWindow(!1),X(!1),o(!1),0!==c.data.errorCode?j(c.data.errorMsg):(ae(!0),j("\u6807\u4e66\u52a0\u5bc6\u6210\u529f!"),setTimeout((function(){eSign.UrlContainer.SetResult(JSON.stringify({result:"1"}))}),1e3));case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i.a.createElement("div",null,O&&i.a.createElement(E["a"],{src:te?k.a:y.a,block:!0,customStyle:{width:"320px",margin:"0 auto",color:"#b3b3b3",paddingTop:"80px"}},i.a.createElement("div",{className:b.a.mt20},i.a.createElement("div",null,O),!te&&i.a.createElement("div",{className:b.a.refresh,onClick:se},"\u7acb\u5373\u5237\u65b0"))),!O&&i.a.createElement(i.a.Fragment,null,C&&i.a.createElement(N["a"],null),!C&&i.a.createElement("div",{className:b.a.caMobile},U&&!B&&i.a.createElement("div",{className:b.a.qrcode},i.a.createElement("div",{className:b.a.loginHeader},"e\u7b7e\u76fe"),i.a.createElement(I.a,{size:160,value:U}),i.a.createElement("div",{className:b.a.mt20},"\u8bf7\u4f7f\u7528\u652f\u4ed8\u5b9d/\u5fae\u4fe1\u6216e\u7b7e\u5b9dAPP\u626b\u7801")),B&&i.a.createElement("div",{className:b.a.mobileContainer},i.a.createElement(p["a"],{className:b.a.form,labelCol:{span:5},wrapperCol:{span:19},autoComplete:"off"},i.a.createElement(p["a"].Item,{label:"\u52a0\u5bc6\u8bc1\u4e66"},i.a.createElement("div",{className:b.a.desc},V)),i.a.createElement(p["a"].Item,{label:"\u539f\u59cb\u6587\u4ef6\u8def\u5f84"},i.a.createElement("div",{className:b.a.desc},t.source||"--")),i.a.createElement(p["a"].Item,{label:"\u52a0\u5bc6\u540e\u6587\u4ef6\u8def\u5f84"},i.a.createElement("div",{className:b.a.desc},t.dest||"--"))),i.a.createElement("div",{className:b.a.footer},i.a.createElement(f["a"],{loading:Q,disabled:!D,className:b.a.subBtn,onClick:le},Q?"\u52a0\u5bc6\u4e2d":"\u52a0\u5bc6"))))))},A=Object(o["a"])((function(e){var t=e.indexPageModel;return{state:t}}))(Object(u["n"])(_)),M=(a("sRBo"),a("kaz8")),B=function(e){var t=e.location.query,a=e.activeKey,n=e.clientCode,o=e.changeStatus,u=e.sealSource,m=O["a"].Option;t=Object(d["k"])(t);var g=p["a"].useForm(),h=Object(s["a"])(g,1),S=h[0],w=Object(l["useState"])(null),x=Object(s["a"])(w,2),K=x[0],U=x[1],I=Object(l["useState"])([]),_=Object(s["a"])(I,2),A=_[0],B=_[1],L=Object(l["useState"])(!0),F=Object(s["a"])(L,2),T=F[0],Y=F[1],q=Object(l["useState"])(!1),P=Object(s["a"])(q,2),W=P[0],D=P[1],G=Object(l["useState"])(!1),J=Object(s["a"])(G,2),R=J[0],V=J[1];Object(l["useEffect"])((function(){if("KG_UKEY"===a){S.resetFields();var e=localStorage.getItem("esign_shield_auto_verify");S.setFieldsValue({verify:"true"==e||null===e})}}),[a]),Object(l["useEffect"])((function(){u.length>0&&H()}),[u]);var H=function(){var e=Object(c["a"])(Object(r["a"])().mark((function e(){var a,c;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return Y(!0),a=u.filter((function(e){return"KG_UKEY"===e.sourceName})),e.next=4,Object(j["u"])(n,t.SignatureMode,a,"UKEY",1,1,1);case 4:c=e.sent,Y(!1),c&&("string"==typeof c?U("\u672a\u68c0\u6d4b\u5230Ukey\uff0c\u8bf7\u68c0\u67e5Ukey\u662f\u5426\u63d2\u5165"===c?"\u672a\u68c0\u6d4b\u5230Ukey\uff0c\u8bf7\u68c0\u67e5Ukey\u662f\u5426\u63d2\u5165\uff0c\u5982\u5df2\u6838\u51c6\uff0c\u8bf7\u70b9\u51fb":c):Array.isArray(c)&&(c.length?c.length>1?U("\u68c0\u6d4b\u5230\u63d2\u5165\u591a\u4e2aUKey\uff0c\u8bf7\u79fb\u9664\u5176\u4ed6UKey"):c[0].encCerts.length>0?(S.setFieldValue("encryptKey",c[0].encCerts[0].certBase64),B(c[0].encCerts)):U("\u672a\u627e\u5230\u6307\u5b9a\u8bc1\u4e66"):U("\u672a\u627e\u5230\u6307\u5b9a\u8bc1\u4e66")));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(){W||(U(null),B([]),H())},Z=function(){W||S.validateFields().then(function(){var e=Object(c["a"])(Object(r["a"])().mark((function e(a){var c,s;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return c={isFile:1,source:t.source,dest:t.dest,keyword:a.encryptKey,sourceName:"KG_UKEY",clientCode:n,verify:Number(a.verify)},D(!0),o(!0),eSign.UrlContainer.LockWindow(!0),e.next=6,Object(v["D"])(c);case 6:s=e.sent,0!==s.data.errorCode?(U(s.data.errorMsg),eSign.UrlContainer.LockWindow(!1),D(!1),o(!1)):Q();case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(){}))},Q=function(){var e=Object(c["a"])(Object(r["a"])().mark((function e(){var t,a,c,s,l,i;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t={sourceName:"KG_UKEY",clientCode:n},e.next=3,Object(v["w"])(t);case 3:a=e.sent,c=a.data,s=c.result,l=c.errorCode,i=c.errorMsg,0!==l?(U(i),eSign.UrlContainer.LockWindow(!1),D(!1),o(!1)):"true"===s?(eSign.UrlContainer.LockWindow(!1),D(!1),o(!1),V(!0),U("\u6807\u4e66\u52a0\u5bc6\u6210\u529f!"),localStorage.setItem("esign_shield_auto_verify",S.getFieldValue("verify")),setTimeout((function(){eSign.UrlContainer.SetResult(JSON.stringify({result:"1"}))}),1e3)):"run"===s?setTimeout((function(){Q()}),1e3):(eSign.UrlContainer.LockWindow(!1),D(!1),o(!1),U("\u6807\u4e66\u52a0\u5bc6\u5931\u8d25!"));case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return i.a.createElement("div",null,i.a.createElement("div",null,!K&&i.a.createElement(i.a.Fragment,null,T&&i.a.createElement(N["a"],null),!T&&i.a.createElement("div",{className:b.a.ukeyContainer},i.a.createElement(p["a"],{form:S,className:b.a.form,labelCol:{span:5},wrapperCol:{span:19},autoComplete:"off"},i.a.createElement(p["a"].Item,{label:"\u52a0\u5bc6\u8bc1\u4e66"},i.a.createElement(p["a"].Item,{name:"encryptKey",rules:[{required:!0,message:"\u8bf7\u9009\u62e9\u52a0\u5bc6\u8bc1\u4e66"}],className:b.a.certItem},i.a.createElement(O["a"],{className:b.a.certSelect,disabled:W},A.map((function(e){return i.a.createElement(m,{key:e.certBase64,value:e.certBase64},e.user)})))),i.a.createElement(p["a"].Item,{className:b.a.refreshItem},i.a.createElement("img",{src:C.a,alt:"\u5237\u65b0",title:"\u5237\u65b0",className:b.a.refresh,onClick:z}))),i.a.createElement(p["a"].Item,{label:"",name:"verify",valuePropName:"checked",wrapperCol:{offset:5,span:19}},i.a.createElement(M["a"],null,"\u52a0\u5bc6\u5b8c\u6210\u81ea\u52a8\u6821\u9a8c\u6587\u4ef6")),i.a.createElement(p["a"].Item,{label:"\u539f\u59cb\u6587\u4ef6\u8def\u5f84"},i.a.createElement("div",{className:b.a.desc},t.source||"--")),i.a.createElement(p["a"].Item,{label:"\u52a0\u5bc6\u540e\u6587\u4ef6\u8def\u5f84"},i.a.createElement("div",{className:b.a.desc},t.dest||"--"))),i.a.createElement("div",{className:b.a.footer},i.a.createElement(f["a"],{className:b.a.subBtn,onClick:Z,loading:W},W?"\u52a0\u5bc6\u4e2d":"\u52a0\u5bc6")))),K&&i.a.createElement(E["a"],{src:R?k.a:y.a,block:!0,customStyle:{width:"320px",margin:"0 auto",color:"#b3b3b3",paddingTop:"80px"}},i.a.createElement("div",{className:b.a.mt20},i.a.createElement("div",null,K),!R&&i.a.createElement("div",{className:b.a.refresh,onClick:z},"\u7acb\u5373\u5237\u65b0")))))},L=Object(o["a"])((function(e){var t=e.indexPageModel;return{state:t}}))(Object(u["n"])(B)),F=function(e){var t=e.location,a=t.pathname,o=t.query;o=Object(d["k"])(o);var u=Object(d["e"])(a),m=Object(l["useState"])("CA_UKEY"),f=Object(s["a"])(m,2),p=f[0],O=f[1],v=Object(l["useState"])(!1),E=Object(s["a"])(v,2),g=E[0],y=E[1],h=Object(l["useState"])([]),C=Object(s["a"])(h,2),S=C[0],k=C[1],N=Object(l["useState"])(!1),w=Object(s["a"])(N,2),K=w[0],U=w[1],I=Object(l["useState"])(!1),_=Object(s["a"])(I,2),M=_[0],B=_[1],F=Object(l["useState"])(!1),T=Object(s["a"])(F,2),Y=T[0],q=T[1];Object(l["useEffect"])((function(){Object(c["a"])(Object(r["a"])().mark((function e(){var t,a,n,c,s;return Object(r["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(j["r"])(u);case 2:t=e.sent,t=t.filter((function(e){return 2===e.sealMode})),k(t),a=t.map((function(e){return e.sourceName})),n=a.includes("CA_UKEY"),c=a.includes("CA_MOBILE"),s=a.includes("KG_UKEY"),U(n),B(c),q(s),!n&&c?O("CA_MOBILE"):n||c||O("KG_UKEY");case 13:case"end":return e.stop()}}),e)})))()}),[]);var P=function(e){O(e)},W=function(e){y(e)};return i.a.createElement("div",{className:b.a.eSignShield},i.a.createElement(i.a.Fragment,null,i.a.createElement(n["a"],{className:b.a.tabs,defaultActiveKey:p,onChange:P},K&&i.a.createElement(n["a"].TabPane,{tab:"UKey\u52a0\u5bc6",key:"CA_UKEY",disabled:g},i.a.createElement(x,{activeKey:p,clientCode:u,sealSource:S,changeStatus:W})),M&&i.a.createElement(n["a"].TabPane,{tab:"\u79fb\u52a8CA\u626b\u7801\u52a0\u5bc6",key:"CA_MOBILE",disabled:g},i.a.createElement(A,{activeKey:p,clientCode:u,changeStatus:W})),Y&&i.a.createElement(n["a"].TabPane,{tab:"UKey\u52a0\u5bc6",key:"KG_UKEY",disabled:g},i.a.createElement(L,{activeKey:p,clientCode:u,sealSource:S,changeStatus:W})))))};t["default"]=Object(o["a"])((function(e){var t=e.indexPageModel;return{state:t}}))(Object(u["n"])(F))}}]);